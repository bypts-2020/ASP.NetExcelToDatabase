@model IEnumerable<UploadExcel.Models.Person>
@{
ViewData["Title"] = "Person";
}

<div class="text-center">
<h1 class="display-4">Welcome to the Person Page</h1>
</div>

<div class="text-center">
    <form asp-controller="Person" asp-action="Index" method="post" enctype="multipart/form-data">
        <input type="file" name="file" /> <button class="btn btn-primary" type="submit">Upload File</button>
    </form>
</div>

    @if(Model.Count() > 0){
        <br />
        <br />
                <div class="text-left"><a class="btn btn-primary" asp-controller="People" asp-action="SaveAllExcel">Save All</a></div>
       <hr />
           <div class="text-center">
            <table class="table table-striped table-bordered">
            <thead class="thead-dark">
            <tr>

                <th>
                        @Html.DisplayNameFor(model => model.Id)
                </th>
                <th>
                        @Html.DisplayNameFor(model => model.FirstName)
                </th>
                <th>
                        @Html.DisplayNameFor(model => model.LastName)
                </th>
                <th>
                        @Html.DisplayNameFor(model => model.Email)
                </th>
                <th>
                        @Html.DisplayNameFor(model => model.Gender)
                </th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                    <td>
                            @Html.DisplayFor(modelItem => item.Id)
                    </td>
                    <td>
                            @Html.DisplayFor(modelItem => item.FirstName)
                    </td>
                    <td>
                            @Html.DisplayFor(modelItem => item.LastName)
                    </td>
                    <td>
                            @Html.DisplayFor(modelItem => item.Email)
                    </td>
                    <td>
                            @Html.DisplayFor(modelItem => item.Gender)
                    </td>
                    <td><a class="btn btn-outline-primary" asp-controller="People" asp-action="SaveExcel" 
                        asp-route-id="@item.Id" 
                        asp-route-first="@item.FirstName"
                        asp-route-last="@item.LastName"
                        asp-route-email="@item.Email"
                        asp-route-gender="@item.Gender"
                    >Save Record</a> </td>
                </tr>
            }
            </tbody>
            </table>
    </div>
    }